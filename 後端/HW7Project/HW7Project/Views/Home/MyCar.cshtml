
@{
    ViewBag.Title = "我的購物車";
}

<h2 class="rounded shadow text-center border-info p-4 text-info mb-4">我的購物車</h2>

<div id="MyCart">


</div>
<h3 class="text-right">總計:<span class="text-danger" id="total"></span></h3>
<hr />
<div class="text-right">
    <button class="btn btn-success">更新購物車</button>
    <button class="btn btn-danger">清空購物車</button>
    <button class="btn btn-primary">結帳</button>
</div>


@section scripts{
    <script>
        var cart = [];

        if (localStorage.getItem("cart")) {
            cart = JSON.parse(localStorage.getItem("cart"));
        }

        let cartList = "";
        let pPrice = 0;
        let total = 0;
        for (let i = 0; i < cart.length; i++) {

            console.log(cart[i]["PName"]);
            pPrice = Number(cart[i]["Price"]) * Number(cart[i]["Amount"]);
            total += pPrice;

            cartList += `
                        <div class="media border-bottom border-danger mb-3 p-4">
                            <img src="/Products/GetImage/${cart[i]["PID"]}" class="mr-3" width="150" alt="...">
                            <div class="media-body">
                                <h5 class="mt-0">${cart[i]["PName"]}</h5>
                                <p class="text-right">
                                    <h5 class="text-right">單價：${cart[i]["Price"]}
                                    數量：<input id="Amount" type="number" value="${cart[i]["Amount"]}" style="width:60px" /></h5>
                                    <h4 class="text-right">小計：<span class="text-danger">${pPrice}<span></h4>
                                    <button class="btn btn-outline-danger">刪除此商品</button>
                                </p>
                            </div>
                        </div>
                    `
        }

        $('#total').text(total);
        $('#MyCart').html(cartList);
    </script>
}